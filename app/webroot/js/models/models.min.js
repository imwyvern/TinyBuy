var app=app||{};app.Delivery=Backbone.Model.extend({defaults:{way:"",time:""},initialize:function(){console.log("A delivery model has been created!")}});app.Extra=Backbone.Model.extend({defaults:{transfee:"",discounts:""},initialize:function(){console.log("An extra model has been created!")}});app.Item=Backbone.Model.extend({defaults:{id:"",cookbook:"",material:"",count:0,total:0},initialize:function(){this.set("id",this.get("Material").id);this.on("invalid",function(t,e){console.log(e)})},validate:function(t){}});app.Order=Backbone.Model.extend({defaults:{id:"",time:"",count:0,total:0,item_count:0,item_total:0,tuan_count:0,tuan_total:0,items:null,tuans:null},initialize:function(){var t=this;var e=new app.ItemCollection;var n=new app.ItemCollection;this.set("items",e);this.set("tuans",n);this.on("invalid",function(t,e){console.log(e)});this.get("items").on("add",function(e){e.set("count",1);e.set("total",parseInt(e.get("Material").price));t.set("item_count",t.get("item_count")+e.get("count"));t.set("item_total",t.get("item_total")+e.get("count")*parseInt(e.get("Material").price));t.set("count",t.get("item_count")+t.get("tuan_count"));t.set("total",t.get("item_total")+t.get("tuan_total"))});this.get("items").on("remove",function(e){t.set("item_count",t.get("item_count")-e.get("count"));t.set("item_total",t.get("item_total")-e.get("count")*parseInt(e.get("Material").price));t.set("count",t.get("item_count")+t.get("tuan_count"));t.set("total",t.get("item_total")+t.get("tuan_total"))});this.get("tuans").on("add",function(e){e.set("count",1);e.set("total",parseInt(e.get("Tutetuan").price));t.set("tuan_count",t.get("tuan_count")+e.get("count"));t.set("tuan_total",t.get("tuan_total")+e.get("count")*parseInt(e.get("Tutetuan").price));t.set("count",t.get("item_count")+t.get("tuan_count"));t.set("total",t.get("item_total")+t.get("tuan_total"))});this.get("tuans").on("remove",function(e){t.set("tuan_count",t.get("tuan_count")-e.get("count"));t.set("tuan_total",t.get("tuan_total")-e.get("count")*parseInt(e.get("Tutetuan").price));t.set("count",t.get("item_count")+t.get("tuan_count"));t.set("total",t.get("item_total")+t.get("tuan_total"))});this.on("change:item_count",function(){t.set("count",t.get("item_count")+t.get("tuan_count"))});this.on("change:item_total",function(){t.set("total",t.get("item_total")+t.get("tuan_total"));$(".items-total-price").html(t.get("item_total"))});this.on("change:tuan_count",function(){t.set("count",t.get("item_count")+t.get("tuan_count"))});this.on("change:tuan_total",function(){t.set("total",t.get("item_total")+t.get("tuan_total"));$(".tuans-total-price").html(t.get("tuan_total"))});this.on("change:count",function(e){$(".total-amount").each(function(){$(this).html(t.get("count"))});if(e.get("count")<=0){app.shoppingCartV.$el.hide()}else{app.shoppingCartV.$el.show()}});this.on("change:total",function(){$(".total-price").each(function(){$(this).html(t.get("total"))})})},validate:function(t){if(typeof t.count!=="number"){return"count must be a number"}else if(typeof t.count==="number"&&t.count<0){return"count can not be less than zero"}}});app.Payment=Backbone.Model.extend({defaults:{online:{name:"online",label:"在线支付",status:false},cool:{name:"cool",label:"货到付款",status:false}},initialize:function(){}});app.Tuan=Backbone.Model.extend({defaults:{Tutetuan:"",count:0,total:0},initialize:function(){this.set("id",this.get("Tutetuan").id);this.on("invalid",function(t,e){console.log(e)})},validate:function(t){}});app.User=Backbone.Model.extend({defaults:{wechatId:"",name:"",address:"",phone:"",remark:""},initialize:function(){this.on("invalid",function(t,e){console.log(e)})},validate:function(t){}});app.ItemCollection=Backbone.Collection.extend({model:app.Item});